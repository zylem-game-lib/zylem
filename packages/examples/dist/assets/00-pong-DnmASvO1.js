import{c as k,a as u,b as y,d as f,g as R,e as V,V as x,f as r,C as l,h as W,m as b,R as X,W as S,r as L,p as N,l as h,s as d}from"./index-BiK7zbrK.js";const g={top:5,bottom:-5,left:-15,right:15},z=R({name:"ball",position:new r(0,0,0),radius:.1,color:new l(l.NAMES.white)}),t=b(z),T=t.use(X,{minSpeed:5,maxSpeed:10,speedMultiplier:1.05,reflectionMode:"angled",maxAngleDeg:60}),H=t.use(S,{boundaries:g});t.onSetup(({me:e})=>{e.setPosition(0,0,0),e.move(new r(5,0,0))});t.onUpdate(({me:e})=>{const o=H.getLastHits();if(!o||!(o.top||o.bottom))return;let n=0;o.bottom&&(n=1),o.top&&(n=-1);const a=T.getRicochet({entity:e,contact:{normal:{x:0,y:n}}});a&&(e.body?.setLinvel({x:a.velocity.x,y:a.velocity.y,z:0},!0),L())});t.onCollision(({entity:e,other:o})=>{if(!o.name||o.name.indexOf("paddle")===-1)return;const s=e.body?.translation(),n=o.body?.translation();if(!s||!n)return;const a=s.x>n.x?1:-1,c=T.getRicochet({entity:e,otherEntity:o,otherSize:v,contact:{normal:{x:a,y:0}}});c&&(e.body?.setLinvel({x:c.velocity.x,y:c.velocity.y,z:0},!0),N())});const v={x:.2,y:1.5,z:1},P={color:new l(l.NAMES.white)},B=5,G=f({name:"paddle1",position:{x:-8,y:0,z:0},size:v,material:P}),M=b(G),O=M.use(S,{boundaries:g});M.onUpdate(({me:e,inputs:o})=>{const{Up:s,Down:n}=o.p1.directions,{Vertical:a}=o.p1.axes;let i=((s.held?1:0)-(n.held?1:0)||-a.value)*B;({moveY:i}=O.getMovement(0,i)),e.moveY(i)});const C=f({name:"paddle2",position:{x:8,y:0,z:0},size:v,material:P}),Y=b(C),Z=Y.use(S,{boundaries:g});Y.onUpdate(({me:e,inputs:o})=>{const{Up:s,Down:n}=o.p2.directions,{Vertical:a}=o.p2.axes;let i=((s.held?1:0)-(n.held?1:0)||-a.value)*B;({moveY:i}=Z.getMovement(0,i)),e.moveY(i)});const D=y({name:"p1Goal",position:{x:12,y:0,z:0},size:new r(2,10,1)});D.onEnter(({visitor:e})=>{const o=h("p1Score")??0;e.uuid===t.uuid&&(d("p1Score",o+1),t.setPosition(0,0,0),t.moveXY(-5,0))});const U=y({name:"p2Goal",position:{x:-12,y:0,z:0},size:new r(2,10,1)});U.onEnter(({visitor:e})=>{const o=h("p2Score")??0;e.uuid===t.uuid&&(d("p2Score",o+1),t.setPosition(0,0,0),t.moveXY(5,0))});const j=W({position:new r(0,0,0),perspective:"fixed-2d",zoom:12}),A=u({name:"p1Text",text:"0",fontSize:24,screenPosition:new x(.45,.05)}),E=u({name:"p2Text",text:"0",fontSize:24,screenPosition:new x(.55,.05)}),p=u({name:"winnerText",text:"",fontSize:36,screenPosition:new x(.5,.5)}),q=V({backgroundColor:new l(l.NAMES.black)},j),m=k({id:"pong",debug:!0,globals:{p1Score:0,p2Score:0,winner:""},input:{p1:{key:{w:["directions.Up"],s:["directions.Down"]}},p2:{key:{ArrowUp:["directions.Up"],ArrowDown:["directions.Down"]}}}},q,z,G,C,D,U,A,E,p),w=3;m.onGlobalChanges(["p1Score","p2Score"],([e,o])=>{e>=w&&(d("winner","p1"),t.setPosition(0,1,0),t.moveXY(0,0)),o>=w&&(d("winner","p2"),t.setPosition(0,1,0),t.moveXY(0,0))});m.onGlobalChange("winner",e=>{console.log("Winner:",e),e==="p1"?p.updateText("P1 Wins!"):e==="p2"?p.updateText("P2 Wins!"):p.updateText("")});m.onGlobalChange("p1Score",e=>{A.updateText(String(e))});m.onGlobalChange("p2Score",e=>{E.updateText(String(e))});export{m as default};
