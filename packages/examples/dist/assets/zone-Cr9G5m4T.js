import{a,h as l,r as h,R as u,U as c,G as E,u as o,E as p}from"./game-DGs2HSrw.js";const d={size:new l(1,1,1),position:new l(0,0,0),collision:{static:!0},material:{shader:"standard"}};class x extends h{collider(e){const t=e.size||new l(1,1,1),s={x:t.x/2,y:t.y/2,z:t.z/2};let i=u.cuboid(s.x,s.y,s.z);return i.setSensor(!0),i.activeCollisionTypes=c.KINEMATIC_FIXED,i}}class Z extends p{createEntity(e){return new r(e)}}const _=Symbol("Zone");class r extends E{static type=_;_enteredZone=new Map;_exitedZone=new Map;_zoneEntities=new Map;constructor(e){super(),this.options={...d,...e}}handlePostCollision({delta:e}){return this._enteredZone.forEach((t,s)=>{this.exited(e,s)}),this._enteredZone.size>0}handleIntersectionEvent({other:e,delta:t}){this._enteredZone.get(e.uuid)?this.held(t,e):(this.entered(e),this._zoneEntities.set(e.uuid,e))}onEnter(e){return this.options.onEnter=e,this}onHeld(e){return this.options.onHeld=e,this}onExit(e){return this.options.onExit=e,this}entered(e){this._enteredZone.set(e.uuid,1),this.options.onEnter&&this.options.onEnter({self:this,visitor:e,globals:o.globals})}exited(e,t){const s=this._exitedZone.get(t);if(s&&s>1+e){this._exitedZone.delete(t),this._enteredZone.delete(t);const i=this._zoneEntities.get(t);this.options.onExit&&this.options.onExit({self:this,visitor:i,globals:o.globals});return}this._exitedZone.set(t,1+e)}held(e,t){const s=this._enteredZone.get(t.uuid)??0;this._enteredZone.set(t.uuid,s+e),this._exitedZone.set(t.uuid,1),this.options.onHeld&&this.options.onHeld({delta:e,self:this,visitor:t,globals:o.globals,heldTime:s})}}async function y(...n){return a({args:n,defaultConfig:d,EntityClass:r,BuilderClass:Z,CollisionBuilderClass:x,entityType:r.type})}export{y as z};
