import{l as f,C as u,d as e,g as X,P as L,k as E,s as W,p as Y,V as k,c as q,b as K,n as O,r as U,o as J,q as d,j as H}from"./index-D8uRGh44.js";import{s as N,w as Q}from"./wood-box-lpOc3WPp.js";import{s as Z}from"./default-Bsz0xHr3.js";const _=async()=>await f({name:"player",position:{x:0,y:2,z:0},size:new e(1,2,1),collision:{static:!1},material:{color:new u(65280),opacity:0}}),ee=()=>X({position:new e(0,1.6,0),perspective:L.FirstPerson}),ae=()=>({health:100,maxHealth:100,ammo:30,maxAmmo:30,speed:12,jumpForce:8,grounded:!1,canShoot:!0,shootCooldown:.15}),te=async()=>await f({name:"weapon",position:{x:.3,y:-.2,z:-.5},size:new e(.1,.1,.3),collision:{static:!0},material:{color:new u(3355443)}}),oe=async(a,o)=>{const t=await W({name:"bullet",position:{x:a.x,y:a.y,z:a.z},size:new e(.1,.1,.1),collision:{static:!1},material:{color:new u(16776960)}});return t.userData={direction:o.clone().normalize(),speed:50,lifetime:3,damage:25},t},r=[],se=async(a,o)=>{const t=await oe(a.clone(),o.clone());return r.push(t),t},ne=a=>{for(let o=r.length-1;o>=0;o--){const t=r[o];t.userData&&(t.userData.lifetime-=a,t.userData.lifetime<=0&&(E(t),r.splice(o,1)))}},le={grunt:{health:50,speed:4,damage:10,size:new e(1,2,1),color:new u(16711680)},heavy:{health:150,speed:2,damage:25,size:new e(1.5,2.5,1.5),color:new u(9109504)},fast:{health:25,speed:8,damage:5,size:new e(.8,1.5,.8),color:new u(16737792)}},ie=async(a,o)=>{const t=le[a],l=await f({name:`enemy-${a}`,position:{x:o.x,y:o.y,z:o.z},size:t.size,collision:{static:!1},material:{color:t.color}});return l.userData={type:a,health:t.health,maxHealth:t.health,speed:t.speed,damage:t.damage,isAlive:!0,lastAttackTime:0,attackCooldown:1},l},h=[],re=async(a,o)=>{const t=await ie(a,o);return h.push(t),t},ce=(a,o)=>{if(a.userData&&a.userData.isAlive&&(a.userData.health-=o,a.userData.health<=0)){a.userData.isAlive=!1,E(a);const t=h.indexOf(a);return t>-1&&h.splice(t,1),!0}return!1},we=(a,o)=>{for(const t of h)t.userData&&t.userData.isAlive&&(new e().subVectors(o,t.body?.translation()||new e(0,0,0)).normalize(),t.userData.lastAttackTime+=a)},me=async()=>await Y({tile:new k(50,50),position:{x:0,y:-2,z:0},collision:{static:!0},material:{path:N,repeat:new k(10,10)}}),i=async(a,o,t=0)=>await f({name:"wall",position:{x:a.x,y:a.y,z:a.z},size:o,collision:{static:!0},material:{path:Q,repeat:new k(o.x/2,o.y/2)}}),ue=async()=>{const a=[];return a.push(await i(new e(0,4/2,25),new e(50,4,.5))),a.push(await i(new e(0,4/2,-25),new e(50,4,.5))),a.push(await i(new e(25,4/2,0),new e(.5,4,50))),a.push(await i(new e(-25,4/2,0),new e(.5,4,50))),a.push(await i(new e(5,1,5),new e(3,2,3))),a.push(await i(new e(-8,1,-3),new e(4,2,2))),a.push(await i(new e(10,1,-10),new e(2,2,5))),a.push(await i(new e(-12,1,8),new e(5,2,2))),a},T=[new e(15,1,15),new e(-15,1,15),new e(15,1,-15),new e(-15,1,-15),new e(0,1,20),new e(0,1,-20),new e(20,1,0),new e(-20,1,0)],pe=ee(),he=await K({gravity:new e(0,-20,0),backgroundImage:Z},pe),m=await _(),de=await te(),ye=await me(),ge=await ue();let s=ae(),$=0,b=!1,y=0,g=0;const C=.002,F=[],fe=async()=>{const a=["grunt","grunt","fast","grunt","heavy"];for(let o=0;o<5;o++){const t=T[o%T.length],l=await re(a[o],t);F.push(l)}},ze=O({id:"fps-demo",debug:!0,bodyBackground:"#1a1a1a",globals:{score:0,kills:0,wave:1}}),xe=q(ze,he,m,de,ye,...ge,...F),w=new e,V=new e,B=new e;let S=0;xe.onSetup(async({})=>{console.log("FPS Demo initialized"),await fe()}).onUpdate(({inputs:a,delta:o})=>{const{p1:t}=a;S+=o;const l=t.axes.Horizontal.value,z=t.axes.Vertical.value,M=l||0,G=z||0;g-=M*C*100,y-=G*C*100,y=Math.max(-Math.PI/2,Math.min(Math.PI/2,y)),V.set(0,0,-1).applyAxisAngle(new e(0,1,0),g),B.set(1,0,0).applyAxisAngle(new e(0,1,0),g),w.set(0,0,0);const A=s.speed;if((Math.abs(l)>.2||Math.abs(z)>.2)&&(w.addScaledVector(B,l*A),w.addScaledVector(V,-z*A)),t.shoulders.LTrigger?.held>0&&w.multiplyScalar(1.5),t.buttons.A.pressed&&b&&(w.y=s.jumpForce,b=!1),w.y-=20,(t.shoulders.RTrigger?.held>0||t.buttons.X.held>0)&&S-$>s.shootCooldown&&s.ammo>0){$=S,s.ammo--;const n=new e(0,0,-1).applyAxisAngle(new e(1,0,0),y).applyAxisAngle(new e(0,1,0),g),{x:c,y:p,z:D}=m.body?.translation()||{x:0,y:0,z:0},x=new e(c,p,D);x.y+=1.6,se(x,n),console.log(`Shot fired! Ammo: ${s.ammo}`)}t.buttons.B.pressed&&s.ammo<s.maxAmmo&&(s.ammo=s.maxAmmo,console.log("Reloaded!")),U(m),J(m,w),ne(o);const{x:I,y:R,z:j}=m.body?.translation()||{x:0,y:0,z:0};we(o,new e(I,R,j));for(let n=r.length-1;n>=0;n--){const c=r[n];if(c.userData)for(const p of h){if(!p.userData?.isAlive)continue;if(c.position.distanceTo(p.position)<1.5){if(ce(p,c.userData.damage)){const v=d("kills")+1,P=d("score")+100;H("kills",v),H("score",P),console.log(`Enemy killed! Total kills: ${v}, Score: ${P}`)}r.splice(n,1);break}}}for(const n of r)if(n.userData){const c=n.userData.direction.clone().multiplyScalar(n.userData.speed*o);n.position.add(c)}(m?.body?.translation()||{y:0}).y<=1&&(b=!0),t.buttons.Start.pressed&&(console.log(`Health: ${s.health} | Ammo: ${s.ammo}/${s.maxAmmo}`),console.log(`Kills: ${d("kills")} | Score: ${d("score")}`))});export{xe as default};
