import{c as V,a as j,i as a,$ as D,A as F}from"./game-CGJ5aPmk.js";import{z}from"./zone-C7xDYqAJ.js";import{r as H,a as P}from"./moveable-CuKxQy8Q.js";import{r as Z}from"./rotatable-CefXLq6d.js";import"./index-CTO3UVAX.js";import{a as G,p as I,b as L}from"./utils-ClmQ-RKm.js";import{s as O}from"./default-Bsz0xHr3.js";import"./box-VXRGqnVK.js";import"./plane-TDvn6oQi.js";import"./mars-surface-LCh_uKaw.js";const u=await j({gravity:new a(0,-9.82,0),backgroundImage:O}),R=await L("dirt"),e=await I("player"),$=await G(),J=await z({position:{x:0,y:0,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),T=await z({position:{x:0,y:20,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),A=V({id:"behaviors-test",debug:!0},u,J,T,R,e,...$);let h=new a,t=new a,v=1,p,x,c=!1,l=!1,m=5;const w=12;A.setup=({camera:o})=>{e.group&&o&&!o.target&&(o.target=e)};A.update=({inputs:o,delta:d})=>{const{p1:i}=o;if(!p){const s=e.body.translation(),r=new a(s.x,s.y,s.z),n=new a(0,-1,0);p=new D({x:r.x,y:r.y,z:r.z},{x:n.x,y:n.y,z:n.z}),x=new F(n,r,v,16711680),u.wrappedStage.scene&&u.wrappedStage.scene.scene.add(x)}const M=e.body.translation(),k=new a(0,-1,0);p.origin=M,p.dir=k,u.wrappedStage.world&&u.wrappedStage.world.world.castRay(p,v,!0,void 0,void 0,void 0,void 0,s=>{const r=s._parent.userData.uuid;return r===e.uuid?!1:(r!==e.uuid&&!l&&(c=!0),!0)});const g=i.axes.Horizontal.value,f=i.axes.Vertical.value,S=new a(0,0,1),E=new a(1,0,0);let y=12;i.shoulders.LTrigger.held>0&&c&&(y=24);const b=9.82;if(t.set(0,0,0),(Math.abs(g)>.2||Math.abs(f)>.2)&&(t.addScaledVector(E,g*y),t.addScaledVector(S,f*y)),i.buttons.A.held>0&&c&&!l&&(l=!0,m=w,c=!1),l&&(m-=d*w,t.y=m+w),t.y-=b,t.y<-b&&(l=!1),H(e),P(e,t),c){const s=Math.abs(t.x),r=Math.abs(t.z),n=Math.max(s,r);n>2&&n<=12?e.playAnimation({key:"walking"}):n>12?e.playAnimation({key:"running"}):e.playAnimation({key:"idle"})}else t.y>5?e.playAnimation({key:"jumping-up",pauseAtEnd:!0}):l===!1&&e.playAnimation({key:"jumping-down",pauseAtEnd:!0});(Math.abs(g)>.2||Math.abs(f)>.2)&&(h=t.clone()),Z(e,h)};export{A as default};
