import{c as V,a as j,V as a,$ as D,A as F}from"./game-v6-6msmH.js";import{z}from"./zone-UZeR73_T.js";import{r as H,a as L}from"./moveable-CGJ6exdo.js";import{r as P}from"./rotatable-COuGsXw7.js";import"./index-BD54UopH.js";import{a as Z,p as G,b as I}from"./utils-DSa3F63E.js";import"./box-D9FUlK78.js";import"./plane-CmuS6IIj.js";const O="/assets/default-urLXfKE6.png",u=await j({gravity:new a(0,-9.82,0),backgroundImage:O}),R=await I("dirt"),e=await G("player"),X=await Z(),$=await z({position:{x:0,y:0,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:n})=>{},onExit:({self:o,visitor:d,globals:n})=>{}}),J=await z({position:{x:0,y:20,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:n})=>{},onExit:({self:o,visitor:d,globals:n})=>{}}),A=V({id:"behaviors-test",debug:!0},u,$,J,R,e,...X);let h=new a,t=new a,v=1,c,x,p=!1,l=!1,m=5;const w=12;A.setup=({camera:o})=>{e.group&&o&&!o.target&&(o.target=e)};A.update=({inputs:o,delta:d})=>{const{p1:n}=o;if(!c){const s=e.body.translation(),r=new a(s.x,s.y,s.z),i=new a(0,-1,0);c=new D({x:r.x,y:r.y,z:r.z},{x:i.x,y:i.y,z:i.z}),x=new F(i,r,v,16711680),u.wrappedStage.scene&&u.wrappedStage.scene.scene.add(x)}const M=e.body.translation(),k=new a(0,-1,0);c.origin=M,c.dir=k,u.wrappedStage.world&&u.wrappedStage.world.world.castRay(c,v,!0,void 0,void 0,void 0,void 0,s=>{const r=s._parent.userData.uuid;return r===e.uuid?!1:(r!==e.uuid&&!l&&(p=!0),!0)});const g=n.axes.Horizontal.value,f=n.axes.Vertical.value,S=new a(0,0,1),E=new a(1,0,0);let y=12;n.shoulders.LTrigger.held>0&&p&&(y=24);const b=9.82;if(t.set(0,0,0),(Math.abs(g)>.2||Math.abs(f)>.2)&&(t.addScaledVector(E,g*y),t.addScaledVector(S,f*y)),n.buttons.A.held>0&&p&&!l&&(l=!0,m=w,p=!1),l&&(m-=d*w,t.y=m+w),t.y-=b,t.y<-b&&(l=!1),H(e),L(e,t),p){const s=Math.abs(t.x),r=Math.abs(t.z),i=Math.max(s,r);i>2&&i<=12?e.playAnimation({key:"walking"}):i>12?e.playAnimation({key:"running"}):e.playAnimation({key:"idle"})}else t.y>5?e.playAnimation({key:"jumping-up",pauseAtEnd:!0}):l===!1&&e.playAnimation({key:"jumping-down",pauseAtEnd:!0});(Math.abs(g)>.2||Math.abs(f)>.2)&&(h=t.clone()),P(e,h)};export{A as default};
