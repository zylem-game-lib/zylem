import{c as G,a as v,b as B,m as y,d as w,e as M,V as g,f as a,g as P,C as u,h as V,W as k,R as X,r as x,s as l,i as Y}from"./index-CC7bRG2V.js";const c={top:10,bottom:-10,left:-12,right:12},S=new a(4,.6,1),H=12,T=w({name:"paddle",position:new a(0,-9,0),size:S,material:{color:new u("#ffffff")}}),z=y(T),A=z.use(k,{boundaries:c});z.onUpdate(({me:e,inputs:t})=>{const{Left:i,Right:s}=t.p1.directions,{Horizontal:n}=t.p1.axes;let m=((s.held?1:0)-(i.held?1:0)||n.value)*H;({moveX:m}=A.getMovement(m,0)),e.moveX(m)});const E=.25,D=P({name:"ball",radius:E,material:{color:new u(u.NAMES.lightgreen)}}),o=y(D),h=o.use(X,{minSpeed:3,maxSpeed:25,speedMultiplier:1,reflectionMode:"angled",maxAngleDeg:60}),W=o.use(k,{boundaries:c});o.onSetup(({me:e})=>{e.setPosition(0,-7,0),e.moveXY(0,8)});o.onUpdate(({me:e})=>{const t=W.getLastHits();if(!t||!(t.top||t.left||t.right))return;let s=0,n=0;t.left&&(s=1),t.right&&(s=-1),t.top&&(n=-1);const r=h.getRicochet({entity:e,contact:{normal:{x:s,y:n}}});r&&(e.body?.setLinvel({x:r.velocity.x,y:r.velocity.y,z:0},!0),x())});o.onCollision(({entity:e,other:t,globals:i})=>{if(t.name!=="brick")return;const s=h.getRicochet({entity:e,otherEntity:t,contact:{}});s&&(e.body?.setLinvel({x:s.velocity.x,y:s.velocity.y,z:0},!0),x(900,.04));const n=i.bricksRemaining-1;l("bricksRemaining",n),l("score",i.score+100),Y(t)});o.onCollision(({entity:e,other:t})=>{if(t.name!=="paddle")return;const i=h.getRicochet({entity:e,otherEntity:t,otherSize:S,contact:{normal:{x:0,y:1}}});i&&(e.body?.setLinvel({x:i.velocity.x,y:i.velocity.y,z:0},!0),x(900,.04))});const R=B({name:"failZone",position:new a(0,c.bottom-1,0),size:new a(c.right-c.left+10,2,1)});R.onEnter(({visitor:e,globals:t})=>{e.uuid===o.uuid&&(t.lives>0&&l("lives",t.lives-1),t.lives!==0?(o.setPosition(0,-7,0),o.moveXY(0,8)):(o.setPosition(0,-2,0),o.moveXY(0,0)))});const Z=4,U=10,p=new a(2,.6,1),$=6,N=.4,b=[];for(let e=0;e<Z;e++)for(let t=0;t<U;t++){const i=c.left+2+t*(p.x+N),s=$-e*(p.y+.6),n=new u().setHSL(.02+e*.08,.8,.5),r=w({name:"brick",size:p,position:new a(i,s,0),material:{color:n},collision:{static:!0}});b.push(r)}const O=V({position:new a(0,0,0),perspective:"fixed-2d",zoom:24}),C=v({name:"scoreText",text:"Score: 0",fontSize:20,stickToViewport:!0,screenPosition:new g(.1,.05)}),L=v({name:"livesText",text:"Lives: 3",fontSize:20,stickToViewport:!0,screenPosition:new g(.9,.05)}),d=v({name:"statusText",text:"",fontSize:32,stickToViewport:!0,screenPosition:new g(.5,.5)}),j=M({},O),f=G({id:"breakout",debug:!0,globals:{score:0,lives:3,bricksRemaining:b.length,status:""},input:{p1:{key:{ArrowLeft:["directions.left"],ArrowRight:["directions.right"],a:["directions.left"],d:["directions.right"]}}}},j,T,o,R,C,L,d,...b);f.onGlobalChanges(["bricksRemaining","lives"],([e,t])=>{e<=0&&l("status","win"),t<=0&&l("status","lose")});f.onGlobalChange("status",e=>{e==="win"?d.updateText("You Win!"):e==="lose"?d.updateText("Game Over"):d.updateText("")});f.onGlobalChange("score",e=>{C.updateText(`Score: ${e}`)});f.onGlobalChange("lives",e=>{L.updateText(`Lives: ${e}`)});export{f as default};
