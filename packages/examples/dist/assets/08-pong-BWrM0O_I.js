import{c as D,t as d,a as E,V as m,i as p,C as r,p as U,m as b,n as c,u as k,v as u}from"./game-QaTDixkd.js";import{b as h}from"./box-gwCz6VtY.js";import{s as M}from"./sphere-PHbgwNWs.js";import{z as T}from"./zone-Dumes8-h.js";import{r as W,a as Y}from"./ricochet-sound-Cw_wkmHi.js";import{r as X}from"./ricochet-2d-collision-DmmTYe-Z.js";import{b as z}from"./boundary-Ckc_cgOC.js";import{m as w}from"./moveable-DggUkBEn.js";import"./index-BAED9BTY.js";function q(e=440,o=.1){N(e,o)}function N(e,o){const t=new(window.AudioContext||window.webkitAudioContext),n=t.createOscillator(),a=t.createGain();n.type="square",n.frequency.value=e,a.gain.setValueAtTime(.05,t.currentTime),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+o),n.connect(a),a.connect(t.destination),n.start(),n.stop(t.currentTime+o)}const x={top:5,bottom:-5,left:-15,right:15},v=await M({name:"ball",position:new p(0,0,0),radius:.1,color:new r(r.NAMES.lightgreen)}),i=w(v).onSetup(({me:e})=>{e.setPosition(0,0,0),e.moveX(5)}).addBehaviors([W({boundaries:x},()=>{Y()}),X({collisionWith:{name:RegExp("paddle")}},()=>{q()})]),y={x:.2,y:1.5,z:1},G={color:new r(r.NAMES.lightblue)},P=5,g=await h({name:"paddle1",position:{x:-10,y:0,z:0},size:y,material:G});w(g).onUpdate(({me:e,inputs:o})=>{const{Up:t,Down:n}=o.p1.directions,{Vertical:a}=o.p1.axes;let l=(t.held?1:0)-(n.held?1:0)||-a.value;e.moveY(l*P)});g.addBehavior(z({boundaries:x}));const S=await h({name:"paddle2",position:{x:10,y:0,z:0},size:y,material:G});w(S).onUpdate(({me:e,inputs:o})=>{const{Up:t,Down:n}=o.p2.directions,{Vertical:a}=o.p2.axes,l=(t.held?1:0)-(n.held?1:0)||-a.value;e.moveY(l*P)});S.addBehavior(z({boundaries:x}));const A=await T({name:"p1Goal",position:{x:12,y:0,z:0},size:new p(2,10,1)});A.onEnter(({visitor:e})=>{const o=b("p1Score")??0;e.uuid===i.uuid&&(c("p1Score",o+1),i.setPosition(0,0,0),i.moveXY(-5,0))});const B=await T({name:"p2Goal",position:{x:-12,y:0,z:0},size:new p(2,10,1)});B.onEnter(({visitor:e})=>{const o=b("p2Score")??0;e.uuid===i.uuid&&(c("p2Score",o+1),i.setPosition(0,0,0),i.moveXY(5,0))});const R=U({position:new p(0,0,0),perspective:"fixed-2d",zoom:12}),C=await d({name:"p1Text",text:"0",fontSize:24,screenPosition:new m(.45,.05)}),V=await d({name:"p2Text",text:"0",fontSize:24,screenPosition:new m(.55,.05)}),s=await d({name:"winnerText",text:"",fontSize:36,screenPosition:new m(.5,.5)}),I=E({},R),Z=D({id:"pong",debug:!0,globals:{p1Score:0,p2Score:0,winner:""},input:{p1:{key:{w:["directions.up"],s:["directions.down"]}},p2:{key:{ArrowUp:["directions.up"],ArrowDown:["directions.down"]}}}},I,v,g,S,A,B,C,V,s),f=3;k(["p1Score","p2Score"],([e,o])=>{e>=f&&c("winner","p1"),o>=f&&c("winner","p2")});u("winner",e=>{console.log("Winner:",e),e==="p1"?s.updateText("P1 Wins!"):e==="p2"?s.updateText("P2 Wins!"):s.updateText("")});u("p1Score",e=>{C.updateText(String(e))});u("p2Score",e=>{V.updateText(String(e))});export{Z as default};
