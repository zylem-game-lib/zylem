import{C as c,i as p,k as V,t as d,V as m,a as U,c as k}from"./game-CGJ5aPmk.js";import{b as S}from"./box-VXRGqnVK.js";import{s as D}from"./sphere-ulFfxzqz.js";import{z as f}from"./zone-C7xDYqAJ.js";import{r as E,a as M}from"./ricochet-sound-Cw_wkmHi.js";import{r as N}from"./ricochet-2d-collision-DncFoDoq.js";import{b as h}from"./boundary-Ckc_cgOC.js";import{m as u}from"./moveable-CuKxQy8Q.js";import"./index-CTO3UVAX.js";import{g as W}from"./global-change-BGJ5r0kM.js";function Y(e=440,o=.1){X(e,o)}function X(e,o){const n=new(window.AudioContext||window.webkitAudioContext),a=n.createOscillator(),i=n.createGain();a.type="square",a.frequency.value=e,i.gain.setValueAtTime(.05,n.currentTime),i.gain.exponentialRampToValueAtTime(.001,n.currentTime+o),a.connect(i),i.connect(n.destination),a.start(),a.stop(n.currentTime+o)}let t;const w={top:5,bottom:-5,left:-15,right:15},T=await D({name:"ball",position:new p(0,0,0),radius:.1,color:new c(c.NAMES.lightgreen)}),s=u(T).onSetup(({me:e})=>{e.setPosition(0,0,0),e.moveX(5)}).addBehaviors([E({boundaries:w},()=>{M()}),N({collisionWith:{name:RegExp("paddle")}},()=>{Y()})]),z={x:.2,y:1.5,z:1},v={color:new c(c.NAMES.lightblue)},G=5,g=await S({name:"paddle1",position:{x:-10,y:0,z:0},size:z,material:v});u(g).onUpdate(({me:e,inputs:o})=>{const{Up:n,Down:a}=o.p1.directions,{Vertical:i}=o.p1.axes;let l=(n.held?1:0)-(a.held?1:0)||-i.value;e.moveY(l*G)});g.addBehavior(h({boundaries:w}));const x=await S({name:"paddle2",position:{x:10,y:0,z:0},size:z,material:v});u(x).onUpdate(({me:e,inputs:o})=>{const{Up:n,Down:a}=o.p2.directions,{Vertical:i}=o.p2.axes,l=(n.held?1:0)-(a.held?1:0)||-i.value;e.moveY(l*G)});x.addBehavior(h({boundaries:w}));const y=await f({name:"p1Goal",position:{x:12,y:0,z:0},size:new p(2,10,1)});y.onEnter(({visitor:e})=>{const o=t.getGlobal("p1Score");e.uuid===s.uuid&&(t.setGlobal("p1Score",Number(o)+1),s.setPosition(0,0,0),s.moveXY(-5,0))});const C=await f({name:"p2Goal",position:{x:-12,y:0,z:0},size:new p(2,10,1)});C.onEnter(({visitor:e})=>{const o=t.getGlobal("p2Score");e.uuid===s.uuid&&(t.setGlobal("p2Score",Number(o)+1),s.setPosition(0,0,0),s.moveXY(5,0))});const q=V({position:new p(0,0,0),perspective:"fixed-2d",zoom:12}),P=await d({name:"p1Text",text:"0",fontSize:24,screenPosition:new m(.45,.05)}),B=await d({name:"p2Text",text:"0",fontSize:24,screenPosition:new m(.55,.05)}),r=await d({name:"winnerText",text:"",fontSize:36,screenPosition:new m(.5,.5)}),A=U({variables:{screenBounces:0}},q);t=k({id:"pong",debug:!0,globals:{p1Score:0,p2Score:0,winner:""},input:{p1:{key:{w:["directions.up"],s:["directions.down"]}},p2:{key:{ArrowUp:["directions.up"],ArrowDown:["directions.down"]}}}},A,T,g,x,y,C,P,B,r);const b=3;A.onUpdate(W(["p1Score","p2Score"],([e,o])=>{e>=b&&t.setGlobal("winner","p1"),o>=b&&t.setGlobal("winner","p2")}));t.onGlobalChange("winner",e=>{console.log("Winner:",e),e==="p1"?r.updateText("P1 Wins!"):e==="p2"?r.updateText("P2 Wins!"):r.updateText("")});t.onGlobalChange("p1Score",e=>{P.updateText(String(e))});t.onGlobalChange("p2Score",e=>{B.updateText(String(e))});const L=t;export{L as default};
