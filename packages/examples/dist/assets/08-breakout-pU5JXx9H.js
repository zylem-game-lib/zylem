import{c as R,t as f,a as y,V as u,i as o,C as r,p as C,u as G,v as b,n as x}from"./game-QaTDixkd.js";import{b as k}from"./box-gwCz6VtY.js";import{s as V}from"./sphere-PHbgwNWs.js";import{z as B}from"./zone-Dumes8-h.js";import{r as L,a as h}from"./ricochet-sound-Cw_wkmHi.js";import{r as v}from"./ricochet-2d-collision-DmmTYe-Z.js";import{b as P}from"./boundary-Ckc_cgOC.js";import{m as g}from"./moveable-DggUkBEn.js";import"./index-BAED9BTY.js";const i={top:10,bottom:-10,left:-12,right:12},$=new o(4,.6,1),M=12,w=await k({name:"paddle",position:new o(0,-9,0),size:$,material:{color:new r("#ffffff")}});g(w).onUpdate(({me:e,inputs:t})=>{const{Left:s,Right:c}=t.p1.directions,{Horizontal:l}=t.p1.axes,d=(c.held?1:0)-(s.held?1:0)||l.value;e.moveX(d*M)});w.addBehavior(P({boundaries:i}));const Y=.25,A=await V({name:"ball",radius:Y,material:{color:new r(r.NAMES.lightgreen)}}),a=g(A).onSetup(({me:e})=>{e.setPosition(0,-7,0),e.moveXY(0,8)}).addBehaviors([L({boundaries:i,maxSpeed:25,minSpeed:3},e=>{console.log(`Ball hit ${e.boundary} at ${e.position.x}, ${e.position.y}`)}),v({collisionWith:{name:"brick"},reflectionMode:"simple"},({other:e,globals:t})=>{h(900,.04);const s=t.bricksRemaining-1;t.bricksRemaining=s,t.score=t.score+100,e.nodeDestroy({me:e,globals:t})}),v({collisionWith:{name:"paddle"},reflectionMode:"angled"},()=>{h(900,.04)})]),S=await B({name:"failZone",position:new o(0,i.bottom-1,0),size:new o(i.right-i.left+10,2,1)});S.onEnter(({visitor:e,globals:t})=>{e.uuid===a.uuid&&(t.lives>0&&(t.lives=t.lives-1),a.setPosition(0,-7,0),a.moveXY(0,8))});const D=4,W=10,m=new o(2,.6,1),X=6,E=.4,p=[];for(let e=0;e<D;e++)for(let t=0;t<W;t++){const s=i.left+2+t*(m.x+E),c=X-e*(m.y+.6),l=new r().setHSL(.02+e*.08,.8,.5),d=await k({name:"brick",size:m,position:new o(s,c,0),material:{color:l},collision:{static:!0}});p.push(d)}const H=C({position:new o(0,0,0),perspective:"fixed-2d",zoom:24}),T=await f({name:"scoreText",text:"Score: 0",fontSize:20,stickToViewport:!0,screenPosition:new u(.1,.05)}),z=await f({name:"livesText",text:"Lives: 3",fontSize:20,stickToViewport:!0,screenPosition:new u(.9,.05)}),n=await f({name:"statusText",text:"",fontSize:32,stickToViewport:!0,screenPosition:new u(.5,.5)}),Z=y({},H),Q=R({id:"breakout",debug:!0,globals:{score:0,lives:3,bricksRemaining:p.length,status:""},input:{p1:{key:{ArrowLeft:["directions.left"],ArrowRight:["directions.right"],a:["directions.left"],d:["directions.right"]}}}},Z,w,a,S,T,z,n,...p);G(["bricksRemaining","lives"],([e,t])=>{e<=0&&x("status","win"),t<=0&&x("status","lose")});b("status",e=>{e==="win"?n.updateText("You Win!"):e==="lose"?n.updateText("Game Over"):n.updateText("")});b("score",e=>{T.updateText(`Score: ${e}`)});b("lives",e=>{z.updateText(`Lives: ${e}`)});export{Q as default};
