import{c as E,z,a as V,e as a,$ as j,A as D,x as F,y as H,B as P}from"./index-ppx1rgNq.js";import{a as Z,p as G,b as I}from"./utils-Bcmw_Dve.js";import{s as L}from"./default-Bsz0xHr3.js";import"./mars-surface-LCh_uKaw.js";const g=await V({gravity:new a(0,-9.82,0),backgroundImage:L}),O=await I("dirt"),e=await G("player"),R=await Z(),$=await z({position:{x:0,y:0,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),B=await z({position:{x:0,y:20,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),J=E({id:"behaviors-test",debug:!0},g,$,B,O,e,...R);let h=new a,t=new a,v=1,c,x,p=!1,l=!1,w=5;const m=12;J.onSetup(({camera:o})=>{e.group&&o&&!o.target&&(o.target=e)}).onUpdate(({inputs:o,delta:d})=>{const{p1:i}=o;if(!c){const s=e.body.translation(),n=new a(s.x,s.y,s.z),r=new a(0,-1,0);c=new j({x:n.x,y:n.y,z:n.z},{x:r.x,y:r.y,z:r.z}),x=new D(r,n,v,16711680),g.wrappedStage.scene&&g.wrappedStage.scene.scene.add(x)}const A=e.body.translation(),M=new a(0,-1,0);c.origin=A,c.dir=M,g.wrappedStage.world&&g.wrappedStage.world.world.castRay(c,v,!0,void 0,void 0,void 0,void 0,s=>{const n=s._parent.userData.uuid;return n===e.uuid?!1:(n!==e.uuid&&!l&&(p=!0),!0)});const u=i.axes.Horizontal.value,y=i.axes.Vertical.value,S=new a(0,0,1),k=new a(1,0,0);let f=12;i.shoulders.LTrigger.held>0&&p&&(f=24);const b=9.82;if(t.set(0,0,0),(Math.abs(u)>.2||Math.abs(y)>.2)&&(t.addScaledVector(k,u*f),t.addScaledVector(S,y*f)),i.buttons.A.held>0&&p&&!l&&(l=!0,w=m,p=!1),l&&(w-=d*m,t.y=w+m),t.y-=b,t.y<-b&&(l=!1),F(e),H(e,t),p){const s=Math.abs(t.x),n=Math.abs(t.z),r=Math.max(s,n);r>2&&r<=12?e.playAnimation({key:"walking"}):r>12?e.playAnimation({key:"running"}):e.playAnimation({key:"idle"})}else t.y>5?e.playAnimation({key:"jumping-up",pauseAtEnd:!0}):l===!1&&e.playAnimation({key:"jumping-down",pauseAtEnd:!0});(Math.abs(u)>.2||Math.abs(y)>.2)&&(h=t.clone()),P(e,h)});export{J as default};
