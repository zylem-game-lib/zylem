import{c as V,z,a as j,e as a,$ as D,A as F,x as H,y as P,B as Z}from"./index-DcsGw34P.js";import{a as G,p as I,b as L}from"./utils-YfEr_ZON.js";import{s as O}from"./default-Bsz0xHr3.js";import"./mars-surface-LCh_uKaw.js";const u=await j({gravity:new a(0,-9.82,0),backgroundImage:O}),R=await L("dirt"),e=await I("player"),$=await G(),B=await z({position:{x:0,y:0,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),J=await z({position:{x:0,y:20,z:0},size:new a(10,10,10),onEnter:({self:o,visitor:d,globals:i})=>{},onExit:({self:o,visitor:d,globals:i})=>{}}),A=V({id:"behaviors-test",debug:!0},u,B,J,R,e,...$);let h=new a,t=new a,v=1,c,x,p=!1,l=!1,w=5;const m=12;A.setup=({camera:o})=>{e.group&&o&&!o.target&&(o.target=e)};A.update=({inputs:o,delta:d})=>{const{p1:i}=o;if(!c){const s=e.body.translation(),n=new a(s.x,s.y,s.z),r=new a(0,-1,0);c=new D({x:n.x,y:n.y,z:n.z},{x:r.x,y:r.y,z:r.z}),x=new F(r,n,v,16711680),u.wrappedStage.scene&&u.wrappedStage.scene.scene.add(x)}const M=e.body.translation(),k=new a(0,-1,0);c.origin=M,c.dir=k,u.wrappedStage.world&&u.wrappedStage.world.world.castRay(c,v,!0,void 0,void 0,void 0,void 0,s=>{const n=s._parent.userData.uuid;return n===e.uuid?!1:(n!==e.uuid&&!l&&(p=!0),!0)});const g=i.axes.Horizontal.value,y=i.axes.Vertical.value,S=new a(0,0,1),E=new a(1,0,0);let f=12;i.shoulders.LTrigger.held>0&&p&&(f=24);const b=9.82;if(t.set(0,0,0),(Math.abs(g)>.2||Math.abs(y)>.2)&&(t.addScaledVector(E,g*f),t.addScaledVector(S,y*f)),i.buttons.A.held>0&&p&&!l&&(l=!0,w=m,p=!1),l&&(w-=d*m,t.y=w+m),t.y-=b,t.y<-b&&(l=!1),H(e),P(e,t),p){const s=Math.abs(t.x),n=Math.abs(t.z),r=Math.max(s,n);r>2&&r<=12?e.playAnimation({key:"walking"}):r>12?e.playAnimation({key:"running"}):e.playAnimation({key:"idle"})}else t.y>5?e.playAnimation({key:"jumping-up",pauseAtEnd:!0}):l===!1&&e.playAnimation({key:"jumping-down",pauseAtEnd:!0});(Math.abs(g)>.2||Math.abs(y)>.2)&&(h=t.clone()),Z(e,h)};export{A as default};
