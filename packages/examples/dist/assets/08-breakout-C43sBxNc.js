import{c as G,t as u,i as R,V as b,h as o,g as c,j as y}from"./game-DGs2HSrw.js";import{b as g}from"./box-hlL6CXkI.js";import{s as C}from"./sphere-BkefUtBB.js";import{z as V}from"./zone-Cr9G5m4T.js";import{r as B,a as h}from"./ricochet-sound-Cw_wkmHi.js";import{r as x}from"./ricochet-2d-collision-B-dPSVxp.js";import{b as L}from"./boundary-Ckc_cgOC.js";import{m as k}from"./moveable-CHW4bsP1.js";import"./index-DgYtinLc.js";import{g as P}from"./global-change-BGJ5r0kM.js";const i={top:10,bottom:-10,left:-12,right:12},$=new o(4,.6,1),M=12,w=await g({name:"paddle",position:new o(0,-9,0),size:$,material:{color:new c("#ffffff")}});k(w).onUpdate(({me:e,inputs:t})=>{const{Left:s,Right:l}=t.p1.directions,{Horizontal:d}=t.p1.axes,m=(l.held?1:0)-(s.held?1:0)||d.value;e.moveX(m*M)});w.addBehavior(L({boundaries:i}));const Y=.25,A=await C({name:"ball",radius:Y,material:{color:new c(c.NAMES.lightgreen)}}),n=k(A).onSetup(({me:e})=>{e.setPosition(0,-7,0),e.moveXY(0,8)}).addBehaviors([B({boundaries:i,maxSpeed:25,minSpeed:3},e=>{console.log(`Ball hit ${e.boundary} at ${e.position.x}, ${e.position.y}`)}),x({collisionWith:{name:"brick"},reflectionMode:"simple"},({other:e,globals:t})=>{h(900,.04);const s=t.bricksRemaining-1;t.bricksRemaining=s,t.score=t.score+100,e.nodeDestroy({me:e,globals:t})}),x({collisionWith:{name:"paddle"},reflectionMode:"angled"},()=>{h(900,.04)})]),v=await V({name:"failZone",position:new o(0,i.bottom-1,0),size:new o(i.right-i.left+10,2,1)});v.onEnter(({visitor:e,globals:t})=>{e.uuid===n.uuid&&(t.lives>0&&(t.lives=t.lives-1),n.setPosition(0,-7,0),n.moveXY(0,8))});const D=4,W=10,p=new o(2,.6,1),X=6,E=.4,f=[];for(let e=0;e<D;e++)for(let t=0;t<W;t++){const s=i.left+2+t*(p.x+E),l=X-e*(p.y+.6),d=new c().setHSL(.02+e*.08,.8,.5),m=await g({name:"brick",size:p,position:new o(s,l,0),material:{color:d},collision:{static:!0}});f.push(m)}const H=y({position:new o(0,0,0),perspective:"fixed-2d",zoom:24}),S=await u({name:"scoreText",text:"Score: 0",fontSize:20,stickToViewport:!0,screenPosition:new b(.1,.05)}),T=await u({name:"livesText",text:"Lives: 3",fontSize:20,stickToViewport:!0,screenPosition:new b(.9,.05)}),r=await u({name:"statusText",text:"",fontSize:32,stickToViewport:!0,screenPosition:new b(.5,.5)}),z=R({},H),a=G({id:"breakout",debug:!0,globals:{score:0,lives:3,bricksRemaining:f.length,status:""},input:{p1:{key:{ArrowLeft:["directions.left"],ArrowRight:["directions.right"],a:["directions.left"],d:["directions.right"]}}}},z,w,n,v,S,T,r,...f);z.onUpdate(P(["bricksRemaining","lives"],([e,t])=>{e<=0&&a.setGlobal("status","win"),t<=0&&a.setGlobal("status","lose")}));a.onGlobalChange("status",e=>{e==="win"?r.updateText("You Win!"):e==="lose"?r.updateText("Game Over"):r.updateText("")});a.onGlobalChange("score",e=>{S.updateText(`Score: ${e}`)});a.onGlobalChange("lives",e=>{T.updateText(`Lives: ${e}`)});export{a as default};
